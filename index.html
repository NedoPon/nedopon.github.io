<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–π –¥–Ω–µ–≤–Ω–∏–∫</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        /* ... –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Å—Ç–∏–ª–∏ ... */
        .login-container {
            max-width: 400px;
            margin: 100px auto;
            animation: fadeIn 0.5s ease-out;
        }
        
        .hidden {
            display: none !important;
        }
    </style>
</head>
<body class="bg-light">
    <!-- –§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞ -->
    <div id="loginSection" class="login-container">
        <div class="card hover-scale">
            <div class="card-header">
                <h3 class="text-center">–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É</h3>
            </div>
            <div class="card-body">
                <form id="loginForm" onsubmit="login(event)">
                    <div class="mb-3">
                        <input type="text" class="form-control" placeholder="–õ–æ–≥–∏–Ω" required>
                    </div>
                    <div class="mb-3">
                        <input type="password" class="form-control" placeholder="–ü–∞—Ä–æ–ª—å" required>
                    </div>
                    <button type="submit" class="btn btn-primary w-100">–í–æ–π—Ç–∏</button>
                </form>
            </div>
        </div>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å -->
    <div id="mainApp" class="container py-5 hidden">
        <header class="d-flex justify-content-between align-items-center mb-4">
            <h1 class="animated-entry">üìö –≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–π –¥–Ω–µ–≤–Ω–∏–∫</h1>
            <div>
                <span id="currentUserRole" class="role-badge"></span>
                <button onclick="logout()" class="btn btn-sm btn-secondary">–í—ã–π—Ç–∏</button>
            </div>
        </header>

        <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤ –∏ —É—á–∏—Ç–µ–ª–µ–π) -->
        <nav id="mainNav" class="nav nav-pills justify-content-center mb-4 animated-entry hidden">
            <button class="nav-link active" onclick="showSection('users')">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</button>
            <button class="nav-link" onclick="showSection('grades')">–û—Ü–µ–Ω–∫–∏</button>
        </nav>

        <!-- –°–µ–∫—Ü–∏—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤) -->
        <section id="usersSection" class="animated-entry hidden">
            <div class="card hover-scale mb-4">
                <div class="card-header">
                    <h3>–î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h3>
                </div>
                <div class="card-body">
                    <form id="userForm" onsubmit="addUser(event)">
                        <div class="row g-3">
                            <div class="col-md-4">
                                <input type="text" class="form-control" placeholder="–õ–æ–≥–∏–Ω" required>
                            </div>
                            <div class="col-md-4">
                                <input type="password" class="form-control" placeholder="–ü–∞—Ä–æ–ª—å" required>
                            </div>
                            <div class="col-md-2">
                                <select class="form-select" required>
                                    <option value="">–†–æ–ª—å</option>
                                    <option>–£—á–µ–Ω–∏–∫</option>
                                    <option>–£—á–∏—Ç–µ–ª—å</option>
                                    <option>–†–æ–¥–∏—Ç–µ–ª—å</option>
                                    <option>–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</option>
                                </select>
                            </div>
                            <div class="col-md-2">
                                <button type="submit" class="btn btn-primary w-100">–î–æ–±–∞–≤–∏—Ç—å</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>

            <div class="row" id="usersList"></div>
        </section>

        <!-- –°–µ–∫—Ü–∏—è –æ—Ü–µ–Ω–æ–∫ -->
        <section id="gradesSection" class="animated-entry hidden">
            <!-- ... –ø—Ä–µ–¥—ã–¥—É—â–∏–π –∫–æ–¥ —Ç–∞–±–ª–∏—Ü—ã –æ—Ü–µ–Ω–æ–∫ ... -->
        </section>
    </div>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
        if(!localStorage.users) localStorage.users = JSON.stringify([]);
        if(!localStorage.grades) localStorage.grades = JSON.stringify({});
        let currentUser = null;

        function login(e) {
            e.preventDefault();
            const form = e.target;
            const login = form[0].value;
            const password = form[1].value;
            
            const users = JSON.parse(localStorage.users);
            const user = users.find(u => u.login === login && u.password === password);
            
            if(user) {
                currentUser = user;
                document.getElementById('loginSection').classList.add('hidden');
                document.getElementById('mainApp').classList.remove('hidden');
                setupInterface();
            } else {
                alert('–ù–µ–≤–µ—Ä–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ!');
            }
        }

        function logout() {
            currentUser = null;
            document.getElementById('mainApp').classList.add('hidden');
            document.getElementById('loginSection').classList.remove('hidden');
        }

        function setupInterface() {
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–æ–ª–∏
            document.getElementById('currentUserRole').textContent = currentUser.role;
            document.getElementById('currentUserRole').className = `role-badge ${getRoleColor(currentUser.role)}`;
            
            // –ü–æ–∫–∞–∑/—Å–∫—Ä—ã—Ç–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
            const isAdmin = currentUser.role === '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä';
            const isTeacher = currentUser.role === '–£—á–∏—Ç–µ–ª—å';
            
            document.getElementById('mainNav').classList.toggle('hidden', !(isAdmin || isTeacher));
            document.getElementById('usersSection').classList.toggle('hidden', !isAdmin);
            document.getElementById('gradesSection').classList.remove('hidden');
            
            renderUsers();
            renderGrades();
        }

        function addUser(e) {
            e.preventDefault();
            if(currentUser.role !== '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä') return;
            
            const form = e.target;
            const user = {
                login: form[0].value,
                password: form[1].value,
                role: form[2].value,
                id: Date.now()
            };

            const users = JSON.parse(localStorage.users);
            users.push(user);
            localStorage.users = JSON.stringify(users);

            renderUsers();
            form.reset();
        }

        function renderUsers() {
            if(currentUser.role !== '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä') return;
            
            const users = JSON.parse(localStorage.users);
            const html = users.map(user => `
                <div class="col-md-3 mb-3">
                    <div class="card hover-scale">
                        <div class="card-body">
                            <h5>${user.login}</h5>
                            <span class="role-badge ${getRoleColor(user.role)} text-white">
                                ${user.role}
                            </span>
                        </div>
                    </div>
                </div>
            `).join('');

            document.getElementById('usersList').innerHTML = html;
        }

        function renderGrades() {
            const grades = JSON.parse(localStorage.grades);
            const users = JSON.parse(localStorage.users).filter(u => u.role === '–£—á–µ–Ω–∏–∫');
            const canEdit = ['–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä', '–£—á–∏—Ç–µ–ª—å'].includes(currentUser.role);
            
            const html = users.map(student => `
                <tr>
                    <td>${student.login}</td>
                    ${['–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞', '–†—É—Å—Å–∫–∏–π', '–ò—Å—Ç–æ—Ä–∏—è', '–§–∏–∑–∏–∫–∞'].map(subject => `
                        <td>
                            ${canEdit ? `
                                <input type="number" min="2" max="5" 
                                       value="${grades[student.id]?.[subject] || ''}" 
                                       onchange="updateGrade(${student.id}, '${subject}', this.value)"
                                       class="form-control form-control-sm">
                            ` : (grades[student.id]?.[subject] || '-')}
                        </td>
                    `).join('')}
                </tr>
            `).join('');

            document.getElementById('gradesTable').innerHTML = html;
        }

        function getRoleColor(role) {
            const colors = {
                '–£—á–µ–Ω–∏–∫': 'bg-primary',
                '–£—á–∏—Ç–µ–ª—å': 'bg-success',
                '–†–æ–¥–∏—Ç–µ–ª—å': 'bg-warning',
                '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä': 'bg-danger'
            };
            return colors[role];
        }

        // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∫–æ–¥–∞ ...
    </script>
</body>
</html>
